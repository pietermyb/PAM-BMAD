name: Penetration Test Scope
description: A document that defines the scope of a penetration test.
elicit: true
elicit-vars:
  - name: application_name
    prompt: "What is the name of the application to be tested?"
  - name: application_urls
    prompt: "What are the URLs of the application to be tested?"
  - name: testing_dates
    prompt: "What are the proposed dates for the penetration test?"
  - name: testing_rules
    prompt: "What are the rules of engagement for the penetration test?"
  - name: test_type
    prompt: "What type of penetration test is this? (External/Internal)"
  - name: test_approach
    prompt: "What approach will be used? (Black-box/Grey-box/White-box)"
  - name: environment_details
    prompt: "What are the details of the test environment?"
  - name: mobile_apps
    prompt: "Are mobile apps included in the scope? If yes, specify Android/iOS variants needed."
  - name: new_features
    prompt: "What new features/capabilities have been added since the last penetration test?"
  - name: mocked_features
    prompt: "What features will be mocked and considered out of scope?"
  - name: user_credentials
    prompt: "What test user credentials will be provided to the testers?"
  - name: guidance_documentation
    prompt: "Will guidance documentation be provided for using the application capabilities?"
template: |
  # Penetration Test Scope for {{application_name}}

  ## Test Overview

  **Test Type:** {{test_type}}  
  **Approach:** {{test_approach}}  
  **Testing Dates:** {{testing_dates}}

  ## Application URLs

  {{application_urls}}

  ## Environment Details

  {{environment_details}}

  ## Rules of Engagement

  {{testing_rules}}

  ## Scope Definition

  ### Features In Scope

  **New Features/Capabilities Added Since Last Penetration Test:**
  {{new_features}}

  **Features Never Penetration Tested Before:**
  - [List features that have not been tested before]

  **Web + Mobile E2E Features (No Mocks):**
  - [List end-to-end features with UI that will be tested]
  - Only features with UI will be tested
  - Features should be available on model bank (exceptions to be highlighted)

  ### Features Out of Scope

  **Mocked Features (Automatically Out of Scope):**
  {{mocked_features}}

  **Features Released Before Previous LTS Version:**
  - [List features that are excluded as they were released before the previous LTS]

  **Features with No UI:**
  - [List backend-only features without user interface]

  **Standard Out of Scope Items:**
  - Denial of Service (DoS) attacks
  - Social engineering attacks
  - Physical security attacks

  ## Mobile Application Requirements

  {{mobile_apps}}

  **Required Mobile App Variants:**
  - Android Dev (Security checks OFF)
  - Android Prod (Security checks ON)
  - iOS Dev (Security checks OFF)
  - iOS Prod (Security checks ON)

  ## Test User Credentials

  {{user_credentials}}

  ## Guidance Documentation

  {{guidance_documentation}}

  **Required Documentation:**
  - User guide for each capability in scope
  - Step-by-step instructions for triggering specific behaviors
  - Button click sequences and workflows
  - Configuration details for test scenarios

  ## Environment Requirements

  **Environment Stability:**
  - Dedicated environment for the entire duration (2-3 weeks)
  - No modifications during testing period
  - No upgrades, configuration changes, or data modifications
  - No automated testing or demos using this environment
  - Latest LTS version deployed

  **Environment Hardening:**
  - Production hardening guide applied
  - Contrast RASP enabled
  - Environment logs sent to Datadog
  - WAF in Monitor mode
  - Previous pen test findings addressed

  ## Known Limitations

  **Mobile Apps:**
  - Mobile apps are not obfuscated (customer responsibility)
  - PAM does not deliver pre-built apps

  **Account Statement Service:**
  - IDOR in Account Statement is a known documented issue
  - Account-statement service does not enforce access control for downloading statements

  ## Success Criteria

  - All in-scope features are accessible and functional
  - Test users have appropriate permissions for all functionalities
  - Environment remains stable throughout testing period
  - All guidance documentation is complete and accurate
